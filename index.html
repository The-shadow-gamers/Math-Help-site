<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Math Help</title>
<link rel="icon" href="icon.png" type="image/png" />

<style>
  :root{
    --bar-h:56px;              /* updated in JS */
    --bg:#0f172a;
    --panel:#0b1220;
    --text:#e5e7eb;
    --muted:#9ca3af;
    --btn:#111827;
    --btnH:#1f2937;
    --accent:#60a5fa;
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
  body{background:var(--bg)}
  body.with-bg-img{background-image:var(--bg-img);background-size:cover;background-position:center;background-attachment:fixed}

  /* Invisible unlock hotspot (top-left) */
  #hotspot{position:fixed;top:0;left:0;width:44px;height:44px;opacity:0;z-index:9999;cursor:pointer}

  /* Down/locked screen */
  #locked{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,#0a49c4,#053a97);color:#dbeafe;text-align:center;z-index:1000;padding:2rem}
  #lockedInner{max-width:720px}
  #lockedIcon{width:64px;height:64px;border-radius:12px;display:block;margin:0 auto 12px}
  #locked h1{margin:.25rem 0 .4rem;font-size:1.8rem}
  #locked p{margin:0;opacity:.9}

  /* Top bar (fixed) */
  .bar{display:none;flex-wrap:wrap;gap:.5rem;padding:.5rem .75rem;background:linear-gradient(180deg,#121a2b,var(--panel));border-bottom:1px solid #0a0f1c;position:fixed;top:0;left:0;right:0;z-index:1200}
  .bar.unlocked{display:flex}
  .bar-row{width:100%;display:flex;align-items:center;gap:.5rem}
  .brand{display:inline-flex;align-items:center;gap:.5rem;padding-right:.5rem;margin-right:.75rem;border-right:1px solid #0a0f1c;color:var(--muted);font-weight:700;user-select:none}
  .brand img{width:22px;height:22px;border-radius:6px}
  .btn{display:inline-flex;align-items:center;gap:.5rem;background:var(--btn);border:1px solid #0a0f1c;color:#e5e7eb;padding:.4rem .6rem;border-radius:10px;cursor:pointer;transition:background .15s,transform .02s;white-space:nowrap}
  .btn:hover{background:var(--btnH)} .btn:active{transform:translateY(1px)}
  .btn img{width:18px;height:18px;border-radius:4px}
  .btn.clear{color:#fca5a5;border-color:#4b1010}
  .bar-left{display:flex;align-items:center;gap:.5rem}
  .bar-right{margin-left:auto;display:flex;align-items:center;gap:.5rem}
  .kbd{font:12px ui-monospace,monospace;background:#0b1220;border:1px solid #1f2937;padding:.1rem .35rem;border-radius:6px;color:#cbd5e1}

  /* Menu restore button (when bar hidden) */
  #menuRestore{display:none;position:fixed;top:8px;right:8px;z-index:1300;background:#111827;border:1px solid #1f2937;color:#e5e7eb;border-radius:10px;padding:.35rem .55rem;cursor:pointer}
  body.bar-hidden #menuRestore{display:block}
  body.bar-hidden .bar{display:none !important}

  /* Tools drawer */
  #toolsDrawer{position:fixed;top:var(--bar-h);right:0;bottom:0;width:360px;background:#0f172a;border-left:1px solid #0a0f1c;transform:translateX(100%);transition:transform .18s ease;z-index:1250;overflow:auto}
  #toolsDrawer.open{transform:translateX(0)}
  #toolsHdr{display:flex;align-items:center;justify-content:space-between;padding:.6rem .8rem;background:#0b1220;border-bottom:1px solid #0a0f1c}
  .toolCard{padding:.8rem;border-bottom:1px solid #0a0f1c}
  .toolRow{display:flex;gap:.5rem;align-items:center;margin:.4rem 0}
  .input{flex:1;background:#0b1220;border:1px solid #111827;border-radius:10px;padding:.6rem .7rem;color:#e5e7eb}
  .small{font-size:.85rem;color:#9ca3af}

  /* Modals */
  .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;z-index:2000}
  .modal.show{display:flex}
  .modal .backdrop{position:absolute;inset:0;background:rgba(0,0,0,.55)}
  .modal .card{position:relative;width:min(92vw,440px);background:#0f172a;border:1px solid #0b1220;border-radius:16px;padding:1rem;box-shadow:0 10px 30px rgba(0,0,0,.45)}
  .modal h2{margin:.3rem 0;color:#c7d2fe}
  .actions{display:flex;gap:.5rem;justify-content:flex-end;margin-top:.75rem}
  .primary{background:#1f2937;border:1px solid #2b3443;color:#e5e7eb;padding:.6rem .9rem;border-radius:10px;cursor:pointer}
  .secondary{background:#0b1220;border:1px solid #1f2937;color:#94a3b8;padding:.6rem .9rem;border-radius:10px;cursor:pointer}
  .toggle{cursor:pointer;padding:.5rem .65rem;background:#111827;border:1px solid #1f2937;border-radius:10px;color:#cbd5e1}
  .err{color:#fca5a5;font-size:.9rem;min-height:1em}

  /* Terminal */
  #termDesk{display:none;position:fixed;inset:0;z-index:3400;background:rgba(0,0,0,.45)}
  #termBox{position:absolute;left:50%;top:10%;transform:translateX(-50%);width:min(900px,95vw);background:#0f172a;border:1px solid #101826;border-radius:14px;box-shadow:0 18px 50px rgba(0,0,0,.55);overflow:hidden}
  #termTop{display:flex;align-items:center;justify-content:space-between;padding:.6rem .8rem;background:#0b1220;border-bottom:1px solid #0a0f1c}
  #termOut{height:320px;overflow:auto;padding:.8rem;font-family:ui-monospace,Menlo,Consolas,monospace;background:#0c1426}
  #termInRow{display:flex;gap:.5rem;align-items:center;padding:.6rem;border-top:1px solid #0a0f1c}
  #termIn{flex:1}

  /* ---- FIX: Embed area always fills below menu ---- */
  #embedArea{position:fixed;top:var(--bar-h);left:0;right:0;bottom:0;z-index:100}
  #embedFrame{width:100%;height:100%;border:0;background:#000}
  #embedLoader{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;background:#0b1220}
  #embedLoaderInner{text-align:center;max-width:320px}
  #embedLogo{width:100px;height:100px;border-radius:14px;display:block;margin:0 auto 12px}
  #embedProg{height:10px;border-radius:999px;background:#0f172a;border:1px solid #1b2233;overflow:hidden}
  #embedProg>span{display:block;height:100%;width:0%;background:linear-gradient(90deg,var(--accent),#38bdf8);animation:loading 2.2s infinite}
  @keyframes loading{0%{width:0%}50%{width:85%}100%{width:0%}}

  /* Browser overlay */
  #browserDesk{display:none;position:fixed;left:0;right:0;top:var(--bar-h);bottom:0;z-index:3300;pointer-events:none}
  #browserWin{position:absolute;left:50%;top:18px;transform:translateX(-50%);width:min(1100px,96vw);height:min(80vh,calc(100vh - var(--bar-h) - 36px));background:#0f172a;border:1px solid #101826;border-radius:14px;box-shadow:0 18px 50px rgba(0,0,0,.55);overflow:hidden;pointer-events:auto}
  #browserTop{display:flex;align-items:center;justify-content:space-between;padding:.6rem .8rem;background:#0b1220;border-bottom:1px solid #0a0f1c;cursor:move}
  #browserBody{position:absolute;inset:44px 0 0 0}
  #browserFrame{position:absolute;inset:0;border:0;width:100%;height:100%;background:#000}
  #browserLoader{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;background:#0b1220}
  #browserLoaderInner{text-align:center;max-width:360px}
  #browserLogo{width:90px;height:90px;border-radius:14px;display:block;margin:0 auto 12px}
  #browserProg{height:10px;border-radius:999px;background:#0f172a;border:1px solid #1b2233;overflow:hidden}
  #browserProg>span{display:block;height:100%;width:0%;background:linear-gradient(90deg,var(--accent),#93c5fd);animation:loading 2.2s infinite}
  #browserErr{position:absolute;inset:0;display:none;align-items:center;justify-content:center;background:#0b1220;text-align:center;padding:1rem}
  #browserWin.full{top:0;left:0;transform:none;width:100vw;height:calc(100vh - var(--bar-h));border-radius:0}
  #browserWin.half{top:0;right:0;left:auto;transform:none;width:50vw;height:calc(100vh - var(--bar-h));border-radius:0}
</style>
</head>
<body>
  <!-- Restore button when menu is hidden -->
  <button id="menuRestore" title="Show menu">â‰¡ Menu</button>

  <!-- Invisible password hotspot -->
  <div id="hotspot" aria-label="Open password"></div>

  <!-- Down screen -->
  <div id="locked">
    <div id="lockedInner">
      <img id="lockedIcon" src="down-favicon-64.png" alt="">
      <h1>Math Help is down right now</h1>
      <p>Please come back later.</p>
    </div>
  </div>

  <!-- Top menu -->
  <div class="bar" id="panel">
    <div class="bar-row">
      <div class="bar-left">
        <span class="brand"><img src="icon.png" alt="">Math Help</span>

        <!-- Tab cloak buttons -->
        <button class="btn" data-title="Calculator" data-favicon="calculator-icon.png"><img src="calculator-icon.png" alt="">Calculator</button>
        <button class="btn" data-title="Google" data-favicon="google-favicon.png"><img src="google-favicon.png" alt="">Google</button>
        <button class="btn" data-title="Google Docs" data-favicon="google-docs-icon.png"><img src="google-docs-icon.png" alt="">Docs</button>
        <button class="btn" data-title="Google Classroom" data-favicon="classroom-favicon.png"><img src="classroom-favicon.png" alt="">Classroom</button>
        <button class="btn" data-title="Khan Academy" data-favicon="khan-favicon.png"><img src="khan-favicon.png" alt="">Khan</button>
        <button class="btn" data-title="Wikipedia" data-favicon="wikipedia-favicon.png"><img src="wikipedia-favicon.png" alt="">Wikipedia</button>
        <button class="btn clear" id="clearCloak">Clear</button>

        <!-- Panic -->
        <div style="display:flex;align-items:center;gap:.5rem;margin-left:.75rem">
          <label for="panicSelect">Panic (<span class="kbd">-</span>):</label>
          <select id="panicSelect">
            <option value='{"title":"Google","icon":"google-favicon.png"}'>Google</option>
            <option value='{"title":"Calculator","icon":"calculator-icon.png"}'>Calculator</option>
            <option value='{"title":"Google Docs","icon":"google-docs-icon.png"}'>Google Docs</option>
            <option value='{"title":"Google Classroom","icon":"classroom-favicon.png"}'>Classroom</option>
            <option value='{"title":"Khan Academy","icon":"khan-favicon.png"}'>Khan Academy</option>
            <option value='{"title":"Wikipedia","icon":"wikipedia-favicon.png"}'>Wikipedia</option>
          </select>
          <button id="panicFire" class="btn">Panic</button>
        </div>

        <!-- Tools / Browser / Terminal -->
        <button id="toolsBtn" class="btn">Tools</button>
        <button id="openBrowser" class="btn">Browser</button>
        <button id="openTermBtn" class="btn">Terminal</button>
      </div>

      <div class="bar-right">
        <button id="collapseBtn" class="btn">Close Menu</button>
      </div>
    </div>

    <div class="bar-row" style="border-top:1px solid #0a0f1c;padding-top:.4rem">
      <span class="brand" style="border-right:none;margin-right:.25rem;padding-right:0;color:#9ca3af">Games</span>
      <button id="openBurrito" class="btn">Burrito Bison</button>
      <button id="openGolfHit" class="btn">Golf Hit</button>
    </div>
  </div>

  <!-- Tools drawer -->
  <aside id="toolsDrawer" aria-hidden="true">
    ...
  </aside>

  <!-- Password Modal -->
  ...
  
  <!-- Embed Area -->
  <div id="embedArea">
    <iframe id="embedFrame" title="Embedded Site"></iframe>
    <div id="embedLoader">
      <div id="embedLoaderInner">
        <img id="embedLogo" src="icon.png" alt="Loading">
        <div id="embedProg"><span></span></div>
        <p class="small" style="text-align:center;margin-top:.6rem">Loadingâ€¦</p>
      </div>
    </div>
  </div>

<script>
/* existing code... */

const BURRITO_URL="/burrito/";

/* Game */
document.getElementById("openBurrito").addEventListener("click",()=>{ window.open(BURRITO_URL,"_blank","noopener"); });
document.getElementById("openGolfHit").addEventListener("click",()=>{ window.open("golfhit.html","_blank","noopener"); });

/* existing code continues... */
</script>
</body>
</html>
